#!/bin/bash

SCREWIM="../screwim"

if [ ! -f "${SCREWIM}" ]; then
	echo 1..1
	echo "ok screwim binary # SKIP because can not found ${SCREWIM}"
	exit 0
fi

echo 1..2 # Number of tests to be executed.

res=$(${SCREWIM} -d test.php.screw 2> /dev/stdout)

if [ $? -eq 0 ]; then
	if [ "${res}" = "Success Decrypting(test.php.screw.discrew)" ]; then
		echo "ok - ${res}"
	else
		echo "not ok - ${res}"
	fi

	old=$(cat test.php)
	new=$(cat test.php.screw.discrew)
	if [ "${old}" = "${new}" ]; then
		echo "ok - Matching decode file"
	else
		echo "not ok - Matching decode file # Check decrypt file that different test.php"
	fi
else
	echo "not ok - decrypt error(${res})"
	echo "ok - Matching decode file # SKIP because decrypt error"
fi

